// Jest Snapshot v1, https://goo.gl/fbAQLP

exports[`Laminar fixtures Should build queries for uuid: Setup Queries 1`] = `
Array [
  Object {
    "text": "INSERT INTO \\"transactions\\" (\\"id\\", \\"amount\\") VALUES ($1,$2)",
    "values": Array [
      "cc2e2b52-ecd3-454a-8143-e0476f2fe6f1",
      10,
    ],
  },
]
`;

exports[`Laminar fixtures Should resolve circular refs 1`] = `
Array [
  Object {
    "columns": Object {
      "account_id": 1,
      "id": 1,
      "title": "contact 1",
    },
    "serialColumn": "id",
    "serialIndex": undefined,
    "table": "fit_contact",
    "updateMaxSerial": true,
  },
  Object {
    "columns": Object {
      "id": 1,
      "primary_contact_id": 1,
    },
    "serialColumn": "id",
    "serialIndex": undefined,
    "table": "fit_account",
    "updateMaxSerial": true,
  },
  Object {
    "columns": Object {
      "account_id": 2,
      "id": 2,
      "title": "contact 2",
    },
    "serialColumn": "id",
    "serialIndex": undefined,
    "table": "fit_contact",
    "updateMaxSerial": true,
  },
  Object {
    "columns": Object {
      "id": 2,
      "primary_contact_id": 2,
    },
    "serialColumn": "id",
    "serialIndex": undefined,
    "table": "fit_account",
    "updateMaxSerial": true,
  },
]
`;

exports[`Laminar fixtures Should start and stop services: Entites 1`] = `
Array [
  Object {
    "columns": Object {
      "address_line_1": "Address 1 1",
      "address_line_2": "Address 1 2",
      "city": "City 1",
      "country": "UK",
      "county": "County 1",
      "id": 1,
      "postcode": "BST SW1",
      "source_system_id": 1,
    },
    "serialColumn": "id",
    "serialIndex": undefined,
    "table": "addresses",
    "updateMaxSerial": true,
  },
  Object {
    "columns": Object {
      "address_id": 1,
      "email": "email1@example.com",
      "first_name": "Test",
      "id": 1,
      "last_name": "Name 1",
      "phone": "11111 %s",
      "title": "Mr",
    },
    "serialColumn": "id",
    "serialIndex": undefined,
    "table": "contacts",
    "updateMaxSerial": true,
  },
  Object {
    "columns": Object {
      "address_line_1": "Address 2 1",
      "address_line_2": "Address 2 2",
      "city": "City 2",
      "country": "UK",
      "county": "County 2",
      "id": 2,
      "postcode": "BST SW2",
      "source_system_id": 2,
    },
    "serialColumn": "id",
    "serialIndex": undefined,
    "table": "addresses",
    "updateMaxSerial": true,
  },
  Object {
    "columns": Object {
      "address_id": 2,
      "email": "email2@example.com",
      "first_name": "Name 2",
      "id": 2,
      "last_name": "Name 2",
      "phone": "11111 %s",
      "title": "Mrs",
    },
    "serialColumn": "id",
    "serialIndex": undefined,
    "table": "contacts",
    "updateMaxSerial": true,
  },
  Object {
    "columns": Object {
      "address_line_1": "Address 3 1",
      "address_line_2": "Address 3 2",
      "city": "City 3",
      "country": "UK",
      "county": "County 3",
      "id": 3,
      "postcode": "BST SW3",
      "source_system_id": 3,
    },
    "serialColumn": "id",
    "serialIndex": undefined,
    "table": "addresses",
    "updateMaxSerial": true,
  },
  Object {
    "columns": Object {
      "billing_address_id": 3,
      "customer_reference": "customer-1",
      "generator_id": "11111-1",
      "id": 1,
      "primary_contact_id": 1,
      "secondary_contact_id": 2,
      "source_system_id": 1,
    },
    "serialColumn": "id",
    "serialIndex": undefined,
    "table": "customers",
    "updateMaxSerial": true,
  },
  Object {
    "columns": Object {
      "customer_id": 1,
      "end_on": undefined,
      "id": 1,
      "payment_plan": "BACs",
      "start_on": 2020-01-01T00:00:00.000Z,
      "state": "Active",
    },
    "serialColumn": "id",
    "serialIndex": undefined,
    "table": "accounts",
    "updateMaxSerial": true,
  },
  Object {
    "columns": Object {
      "address_line_1": "Address 4 1",
      "address_line_2": "Address 4 2",
      "city": "City 4",
      "country": "UK",
      "county": "County 4",
      "id": 4,
      "postcode": "BST SW4",
      "source_system_id": 4,
    },
    "serialColumn": "id",
    "serialIndex": undefined,
    "table": "addresses",
    "updateMaxSerial": true,
  },
  Object {
    "columns": Object {
      "address_id": 4,
      "commissioned_on": 2020-01-01T00:00:00.000Z,
      "dnc_reference": 1000,
      "export_mpan": "11111111111111111",
      "export_type": "Deemed",
      "id": 1,
      "installed_on": 2020-01-01T00:00:00.000Z,
      "legacy_fit_db_id": "FIT1",
      "mcs_reference": "123",
      "name": "Installation 1",
      "property_type": "Domestic",
      "source_system_id": 1,
      "supply_mpan": "11111111111111111",
      "technology_type": "PV",
      "tic_reference": 1000,
      "type": "Retrofit",
    },
    "serialColumn": "id",
    "serialIndex": undefined,
    "table": "installations",
    "updateMaxSerial": true,
  },
  Object {
    "columns": Object {
      "code": "Tariff 1",
      "id": 1,
      "source_system_id": 1,
      "type": "Generation",
    },
    "serialColumn": "id",
    "serialIndex": undefined,
    "table": "tariffs",
    "updateMaxSerial": true,
  },
  Object {
    "columns": Object {
      "code": "Tariff 2",
      "id": 2,
      "source_system_id": 2,
      "type": "Export",
    },
    "serialColumn": "id",
    "serialIndex": undefined,
    "table": "tariffs",
    "updateMaxSerial": true,
  },
  Object {
    "columns": Object {
      "address_line_1": "Address 5 1",
      "address_line_2": "Address 5 2",
      "city": "City 5",
      "country": "UK",
      "county": "County 5",
      "id": 5,
      "postcode": "BST SW5",
      "source_system_id": 5,
    },
    "serialColumn": "id",
    "serialIndex": undefined,
    "table": "addresses",
    "updateMaxSerial": true,
  },
  Object {
    "columns": Object {
      "address_id": 5,
      "email": "email3@example.com",
      "first_name": "Name 3",
      "id": 3,
      "last_name": "Name 3",
      "phone": "11111 %s",
      "title": "Mr",
    },
    "serialColumn": "id",
    "serialIndex": undefined,
    "table": "contacts",
    "updateMaxSerial": true,
  },
  Object {
    "columns": Object {
      "account_id": 1,
      "contact_id": 3,
      "export_tariff_id": 2,
      "generation_tariff_id": 1,
      "id": 1,
      "installation_id": 1,
      "scheme_account_reference": "FIT1",
      "scheme_type": "FIT",
      "source_system_id": 1,
      "terms_and_conditions_agreed": true,
    },
    "serialColumn": "id",
    "serialIndex": undefined,
    "table": "contracts",
    "updateMaxSerial": true,
  },
  Object {
    "columns": Object {
      "gsp": "_L",
      "hh_metered": true,
      "id": 1,
      "make": "Make 1",
      "model": "Model 1",
      "mpan": "11111111",
      "serial_number": "123123123",
      "shared": false,
      "source_system_id": 1,
    },
    "serialColumn": "id",
    "serialIndex": undefined,
    "table": "meters",
    "updateMaxSerial": true,
  },
  Object {
    "columns": Object {
      "id": 1,
      "installation_id": 1,
      "meter_id": 1,
      "meter_type": "Generation",
      "source_system_id": 1,
      "start_on": 2020-01-01T00:00:00.000Z,
    },
    "serialColumn": "id",
    "serialIndex": undefined,
    "table": "installation_meters",
    "updateMaxSerial": true,
  },
  Object {
    "columns": Object {
      "gsp": "_L",
      "hh_metered": true,
      "id": 2,
      "make": "Make 2",
      "model": "Model 2",
      "mpan": "11111111",
      "serial_number": "123123123",
      "shared": false,
      "source_system_id": 2,
    },
    "serialColumn": "id",
    "serialIndex": undefined,
    "table": "meters",
    "updateMaxSerial": true,
  },
  Object {
    "columns": Object {
      "id": 2,
      "installation_id": 1,
      "meter_id": 2,
      "meter_type": "Export",
      "source_system_id": 2,
      "start_on": 2020-01-01T00:00:00.000Z,
    },
    "serialColumn": "id",
    "serialIndex": undefined,
    "table": "installation_meters",
    "updateMaxSerial": true,
  },
  Object {
    "columns": Object {
      "end_date_on": 3000-01-01T00:00:00.000Z,
      "id": 1,
      "rate": 5,
      "source_system_id": 1,
      "start_date_on": 2000-01-01T00:00:00.000Z,
      "tariff_id": 1,
    },
    "serialColumn": "id",
    "serialIndex": undefined,
    "table": "tariff_rates",
    "updateMaxSerial": true,
  },
  Object {
    "columns": Object {
      "end_date_on": 3000-01-01T00:00:00.000Z,
      "id": 2,
      "rate": 5,
      "source_system_id": 2,
      "start_date_on": 2000-01-01T00:00:00.000Z,
      "tariff_id": 1,
    },
    "serialColumn": "id",
    "serialIndex": undefined,
    "table": "tariff_rates",
    "updateMaxSerial": true,
  },
  Object {
    "columns": Object {
      "date_on": 2021-01-01T00:00:00.000Z,
      "deleted_at": undefined,
      "history": "[]",
      "id": 1,
      "is_accepted": true,
      "meter_id": 1,
      "reason": "FQ1",
      "source_system_id": 1,
      "submitted_at": 2020-01-01T00:00:00.000Z,
      "tolerance": 0,
      "type": "Opening",
      "value": 0,
    },
    "serialColumn": "id",
    "serialIndex": undefined,
    "table": "fixtures_meter_reads",
    "updateMaxSerial": true,
  },
  Object {
    "columns": Object {
      "date_on": 2021-03-01T00:00:00.000Z,
      "deleted_at": undefined,
      "history": "[]",
      "id": 2,
      "is_accepted": true,
      "meter_id": 1,
      "reason": "Opening",
      "source_system_id": 2,
      "submitted_at": 2020-01-01T00:00:00.000Z,
      "tolerance": 0,
      "type": "Quarterly",
      "value": 100,
    },
    "serialColumn": "id",
    "serialIndex": undefined,
    "table": "fixtures_meter_reads",
    "updateMaxSerial": true,
  },
  Object {
    "columns": Object {
      "date_on": 2021-01-01T00:00:00.000Z,
      "deleted_at": undefined,
      "history": "[]",
      "id": 3,
      "is_accepted": true,
      "meter_id": 2,
      "reason": "FQ1",
      "source_system_id": 3,
      "submitted_at": 2020-01-01T00:00:00.000Z,
      "tolerance": 0,
      "type": "Opening",
      "value": 0,
    },
    "serialColumn": "id",
    "serialIndex": undefined,
    "table": "fixtures_meter_reads",
    "updateMaxSerial": true,
  },
  Object {
    "columns": Object {
      "date_on": 2021-03-01T00:00:00.000Z,
      "deleted_at": undefined,
      "history": "[]",
      "id": 4,
      "is_accepted": true,
      "meter_id": 2,
      "reason": "Opening",
      "source_system_id": 4,
      "submitted_at": 2020-01-01T00:00:00.000Z,
      "tolerance": 0,
      "type": "Quarterly",
      "value": 100,
    },
    "serialColumn": "id",
    "serialIndex": undefined,
    "table": "fixtures_meter_reads",
    "updateMaxSerial": true,
  },
]
`;

exports[`Laminar fixtures Should start and stop services: Setup Queries 1`] = `
Array [
  Object {
    "text": "INSERT INTO \\"addresses\\" (\\"id\\", \\"city\\", \\"county\\", \\"country\\", \\"postcode\\", \\"address_line_1\\", \\"address_line_2\\", \\"source_system_id\\") VALUES ($1,$2,$3,$4,$5,$6,$7,$8),($9,$10,$11,$12,$13,$14,$15,$16),($17,$18,$19,$20,$21,$22,$23,$24),($25,$26,$27,$28,$29,$30,$31,$32),($33,$34,$35,$36,$37,$38,$39,$40)",
    "values": Array [
      1,
      "City 1",
      "County 1",
      "UK",
      "BST SW1",
      "Address 1 1",
      "Address 1 2",
      1,
      2,
      "City 2",
      "County 2",
      "UK",
      "BST SW2",
      "Address 2 1",
      "Address 2 2",
      2,
      3,
      "City 3",
      "County 3",
      "UK",
      "BST SW3",
      "Address 3 1",
      "Address 3 2",
      3,
      4,
      "City 4",
      "County 4",
      "UK",
      "BST SW4",
      "Address 4 1",
      "Address 4 2",
      4,
      5,
      "City 5",
      "County 5",
      "UK",
      "BST SW5",
      "Address 5 1",
      "Address 5 2",
      5,
    ],
  },
  Object {
    "text": "SELECT setval(pg_get_serial_sequence('addresses', 'id'), coalesce(max(\\"id\\"), 0)+1 , false) FROM \\"addresses\\";",
    "values": Array [],
  },
  Object {
    "text": "INSERT INTO \\"contacts\\" (\\"id\\", \\"address_id\\", \\"title\\", \\"first_name\\", \\"last_name\\", \\"email\\", \\"phone\\") VALUES ($1,$2,$3,$4,$5,$6,$7),($8,$9,$10,$11,$12,$13,$14),($15,$16,$17,$18,$19,$20,$21)",
    "values": Array [
      1,
      1,
      "Mr",
      "Test",
      "Name 1",
      "email1@example.com",
      "11111 %s",
      2,
      2,
      "Mrs",
      "Name 2",
      "Name 2",
      "email2@example.com",
      "11111 %s",
      3,
      5,
      "Mr",
      "Name 3",
      "Name 3",
      "email3@example.com",
      "11111 %s",
    ],
  },
  Object {
    "text": "SELECT setval(pg_get_serial_sequence('contacts', 'id'), coalesce(max(\\"id\\"), 0)+1 , false) FROM \\"contacts\\";",
    "values": Array [],
  },
  Object {
    "text": "INSERT INTO \\"customers\\" (\\"id\\", \\"customer_reference\\", \\"primary_contact_id\\", \\"secondary_contact_id\\", \\"billing_address_id\\", \\"source_system_id\\", \\"generator_id\\") VALUES ($1,$2,$3,$4,$5,$6,$7)",
    "values": Array [
      1,
      "customer-1",
      1,
      2,
      3,
      1,
      "11111-1",
    ],
  },
  Object {
    "text": "SELECT setval(pg_get_serial_sequence('customers', 'id'), coalesce(max(\\"id\\"), 0)+1 , false) FROM \\"customers\\";",
    "values": Array [],
  },
  Object {
    "text": "INSERT INTO \\"accounts\\" (\\"id\\", \\"customer_id\\", \\"state\\", \\"payment_plan\\", \\"start_on\\", \\"end_on\\") VALUES ($1,$2,$3,$4,$5,$6)",
    "values": Array [
      1,
      1,
      "Active",
      "BACs",
      2020-01-01T00:00:00.000Z,
      null,
    ],
  },
  Object {
    "text": "SELECT setval(pg_get_serial_sequence('accounts', 'id'), coalesce(max(\\"id\\"), 0)+1 , false) FROM \\"accounts\\";",
    "values": Array [],
  },
  Object {
    "text": "INSERT INTO \\"installations\\" (\\"id\\", \\"name\\", \\"type\\", \\"technology_type\\", \\"property_type\\", \\"export_type\\", \\"commissioned_on\\", \\"installed_on\\", \\"mcs_reference\\", \\"tic_reference\\", \\"dnc_reference\\", \\"export_mpan\\", \\"source_system_id\\", \\"legacy_fit_db_id\\", \\"supply_mpan\\", \\"address_id\\") VALUES ($1,$2,$3,$4,$5,$6,$7,$8,$9,$10,$11,$12,$13,$14,$15,$16)",
    "values": Array [
      1,
      "Installation 1",
      "Retrofit",
      "PV",
      "Domestic",
      "Deemed",
      2020-01-01T00:00:00.000Z,
      2020-01-01T00:00:00.000Z,
      "123",
      1000,
      1000,
      "11111111111111111",
      1,
      "FIT1",
      "11111111111111111",
      4,
    ],
  },
  Object {
    "text": "SELECT setval(pg_get_serial_sequence('installations', 'id'), coalesce(max(\\"id\\"), 0)+1 , false) FROM \\"installations\\";",
    "values": Array [],
  },
  Object {
    "text": "INSERT INTO \\"tariffs\\" (\\"id\\", \\"code\\", \\"type\\", \\"source_system_id\\") VALUES ($1,$2,$3,$4),($5,$6,$7,$8)",
    "values": Array [
      1,
      "Tariff 1",
      "Generation",
      1,
      2,
      "Tariff 2",
      "Export",
      2,
    ],
  },
  Object {
    "text": "SELECT setval(pg_get_serial_sequence('tariffs', 'id'), coalesce(max(\\"id\\"), 0)+1 , false) FROM \\"tariffs\\";",
    "values": Array [],
  },
  Object {
    "text": "INSERT INTO \\"contracts\\" (\\"id\\", \\"scheme_type\\", \\"scheme_account_reference\\", \\"terms_and_conditions_agreed\\", \\"installation_id\\", \\"generation_tariff_id\\", \\"export_tariff_id\\", \\"source_system_id\\", \\"contact_id\\", \\"account_id\\") VALUES ($1,$2,$3,$4,$5,$6,$7,$8,$9,$10)",
    "values": Array [
      1,
      "FIT",
      "FIT1",
      true,
      1,
      1,
      2,
      1,
      3,
      1,
    ],
  },
  Object {
    "text": "SELECT setval(pg_get_serial_sequence('contracts', 'id'), coalesce(max(\\"id\\"), 0)+1 , false) FROM \\"contracts\\";",
    "values": Array [],
  },
  Object {
    "text": "INSERT INTO \\"meters\\" (\\"id\\", \\"mpan\\", \\"shared\\", \\"serial_number\\", \\"make\\", \\"model\\", \\"hh_metered\\", \\"gsp\\", \\"source_system_id\\") VALUES ($1,$2,$3,$4,$5,$6,$7,$8,$9),($10,$11,$12,$13,$14,$15,$16,$17,$18)",
    "values": Array [
      1,
      "11111111",
      false,
      "123123123",
      "Make 1",
      "Model 1",
      true,
      "_L",
      1,
      2,
      "11111111",
      false,
      "123123123",
      "Make 2",
      "Model 2",
      true,
      "_L",
      2,
    ],
  },
  Object {
    "text": "SELECT setval(pg_get_serial_sequence('meters', 'id'), coalesce(max(\\"id\\"), 0)+1 , false) FROM \\"meters\\";",
    "values": Array [],
  },
  Object {
    "text": "INSERT INTO \\"installation_meters\\" (\\"id\\", \\"meter_type\\", \\"meter_id\\", \\"installation_id\\", \\"start_on\\", \\"source_system_id\\") VALUES ($1,$2,$3,$4,$5,$6),($7,$8,$9,$10,$11,$12)",
    "values": Array [
      1,
      "Generation",
      1,
      1,
      2020-01-01T00:00:00.000Z,
      1,
      2,
      "Export",
      2,
      1,
      2020-01-01T00:00:00.000Z,
      2,
    ],
  },
  Object {
    "text": "SELECT setval(pg_get_serial_sequence('installation_meters', 'id'), coalesce(max(\\"id\\"), 0)+1 , false) FROM \\"installation_meters\\";",
    "values": Array [],
  },
  Object {
    "text": "INSERT INTO \\"tariff_rates\\" (\\"id\\", \\"tariff_id\\", \\"rate\\", \\"start_date_on\\", \\"end_date_on\\", \\"source_system_id\\") VALUES ($1,$2,$3,$4,$5,$6),($7,$8,$9,$10,$11,$12)",
    "values": Array [
      1,
      1,
      5,
      2000-01-01T00:00:00.000Z,
      3000-01-01T00:00:00.000Z,
      1,
      2,
      1,
      5,
      2000-01-01T00:00:00.000Z,
      3000-01-01T00:00:00.000Z,
      2,
    ],
  },
  Object {
    "text": "SELECT setval(pg_get_serial_sequence('tariff_rates', 'id'), coalesce(max(\\"id\\"), 0)+1 , false) FROM \\"tariff_rates\\";",
    "values": Array [],
  },
  Object {
    "text": "INSERT INTO \\"fixtures_meter_reads\\" (\\"id\\", \\"meter_id\\", \\"date_on\\", \\"value\\", \\"type\\", \\"reason\\", \\"source_system_id\\", \\"tolerance\\", \\"is_accepted\\", \\"deleted_at\\", \\"submitted_at\\", \\"history\\") VALUES ($1,$2,$3,$4,$5,$6,$7,$8,$9,$10,$11,$12),($13,$14,$15,$16,$17,$18,$19,$20,$21,$22,$23,$24),($25,$26,$27,$28,$29,$30,$31,$32,$33,$34,$35,$36),($37,$38,$39,$40,$41,$42,$43,$44,$45,$46,$47,$48)",
    "values": Array [
      1,
      1,
      2021-01-01T00:00:00.000Z,
      0,
      "Opening",
      "FQ1",
      1,
      0,
      true,
      null,
      2020-01-01T00:00:00.000Z,
      "[]",
      2,
      1,
      2021-03-01T00:00:00.000Z,
      100,
      "Quarterly",
      "Opening",
      2,
      0,
      true,
      null,
      2020-01-01T00:00:00.000Z,
      "[]",
      3,
      2,
      2021-01-01T00:00:00.000Z,
      0,
      "Opening",
      "FQ1",
      3,
      0,
      true,
      null,
      2020-01-01T00:00:00.000Z,
      "[]",
      4,
      2,
      2021-03-01T00:00:00.000Z,
      100,
      "Quarterly",
      "Opening",
      4,
      0,
      true,
      null,
      2020-01-01T00:00:00.000Z,
      "[]",
    ],
  },
  Object {
    "text": "SELECT setval(pg_get_serial_sequence('fixtures_meter_reads', 'id'), coalesce(max(\\"id\\"), 0)+1 , false) FROM \\"fixtures_meter_reads\\";",
    "values": Array [],
  },
]
`;

exports[`Laminar fixtures Should start and stop services: Teardown Queries 1`] = `
Array [
  Object {
    "text": "DELETE FROM \\"fixtures_meter_reads\\" WHERE id IN ($1, $2, $3, $4)",
    "values": Array [
      1,
      2,
      3,
      4,
    ],
  },
  Object {
    "text": "DELETE FROM \\"tariff_rates\\" WHERE id IN ($1, $2)",
    "values": Array [
      1,
      2,
    ],
  },
  Object {
    "text": "DELETE FROM \\"installation_meters\\" WHERE id IN ($1, $2)",
    "values": Array [
      1,
      2,
    ],
  },
  Object {
    "text": "DELETE FROM \\"meters\\" WHERE id IN ($1, $2)",
    "values": Array [
      1,
      2,
    ],
  },
  Object {
    "text": "DELETE FROM \\"contracts\\" WHERE id IN ($1)",
    "values": Array [
      1,
    ],
  },
  Object {
    "text": "DELETE FROM \\"tariffs\\" WHERE id IN ($1, $2)",
    "values": Array [
      1,
      2,
    ],
  },
  Object {
    "text": "DELETE FROM \\"installations\\" WHERE id IN ($1)",
    "values": Array [
      1,
    ],
  },
  Object {
    "text": "DELETE FROM \\"accounts\\" WHERE id IN ($1)",
    "values": Array [
      1,
    ],
  },
  Object {
    "text": "DELETE FROM \\"customers\\" WHERE id IN ($1)",
    "values": Array [
      1,
    ],
  },
  Object {
    "text": "DELETE FROM \\"contacts\\" WHERE id IN ($1, $2, $3)",
    "values": Array [
      1,
      2,
      3,
    ],
  },
  Object {
    "text": "DELETE FROM \\"addresses\\" WHERE id IN ($1, $2, $3, $4, $5)",
    "values": Array [
      1,
      2,
      3,
      4,
      5,
    ],
  },
]
`;
